-- MySQL Script generated by MySQL Workbench
-- Wed Jan  5 19:23:59 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS = @@UNIQUE_CHECKS, UNIQUE_CHECKS = 0;
SET @OLD_FOREIGN_KEY_CHECKS = @@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS = 0;
SET @OLD_SQL_MODE = @@SQL_MODE, SQL_MODE =
        'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema bddprojet
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `bddprojet`;

-- -----------------------------------------------------
-- Schema bddprojet
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `bddprojet` DEFAULT CHARACTER SET utf8;
SHOW WARNINGS;
USE `bddprojet`;

-- -----------------------------------------------------
-- Table `bddprojet`.`action`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`action`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`action`
(
    `idaction` INT         NOT NULL AUTO_INCREMENT,
    `price`    FLOAT       NULL,
    `symbol`   VARCHAR(45) NULL,
    `name`     VARCHAR(45) NULL,
    PRIMARY KEY (`idaction`)
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`assurancevie`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`assurancevie`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`assurancevie`
(
    `idassurancevie`              INT         NOT NULL AUTO_INCREMENT,
    `comptebourse_idcomptebourse` INT         NOT NULL,
    `intitule`                    VARCHAR(45) NULL,
    `montant`                     FLOAT       NULL,
    PRIMARY KEY (`idassurancevie`),
    INDEX `fk_assurancevie_comptebourse1_idx` (`comptebourse_idcomptebourse` ASC) VISIBLE,
    CONSTRAINT `fk_assurancevie_comptebourse1`
        FOREIGN KEY (`comptebourse_idcomptebourse`)
            REFERENCES `bddprojet`.`comptebourse` (`idcomptebourse`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`assurancevie_has_action`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`assurancevie_has_action`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`assurancevie_has_action`
(
    `assurancevie_idassurancevie` INT   NOT NULL,
    `action_idaction`             INT   NOT NULL,
    `prixachat`                   FLOAT NULL,
    `dateachat`                   DATE  NULL,
    `quantite`                    INT   NULL,
    PRIMARY KEY (`assurancevie_idassurancevie`, `action_idaction`),
    INDEX `fk_assurancevie_has_action_action1_idx` (`action_idaction` ASC) VISIBLE,
    INDEX `fk_assurancevie_has_action_assurancevie1_idx` (`assurancevie_idassurancevie` ASC) VISIBLE,
    CONSTRAINT `fk_assurancevie_has_action_assurancevie1`
        FOREIGN KEY (`assurancevie_idassurancevie`)
            REFERENCES `bddprojet`.`assurancevie` (`idassurancevie`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION,
    CONSTRAINT `fk_assurancevie_has_action_action1`
        FOREIGN KEY (`action_idaction`)
            REFERENCES `bddprojet`.`action` (`idaction`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`comptebourse`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`comptebourse`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`comptebourse`
(
    `idcomptebourse` INT NOT NULL AUTO_INCREMENT,
    PRIMARY KEY (`idcomptebourse`)
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`comptecourant`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`comptecourant`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`comptecourant`
(
    `idcomptecourant` INT         NOT NULL AUTO_INCREMENT,
    `montant`         FLOAT       NULL,
    `intitule`        VARCHAR(45) NULL DEFAULT 'Compte Courant',
    PRIMARY KEY (`idcomptecourant`)
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`enveloppe`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`enveloppe`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`enveloppe`
(
    `idenveloppe`                   INT NOT NULL AUTO_INCREMENT,
    `comptecourant_idcomptecourant` INT NOT NULL,
    `comptebourse_idcomptebourse`   INT NOT NULL,
    PRIMARY KEY (`idenveloppe`),
    INDEX `fk_enveloppe_comptecourant1_idx` (`comptecourant_idcomptecourant` ASC) VISIBLE,
    INDEX `fk_enveloppe_comptebourse1_idx` (`comptebourse_idcomptebourse` ASC) VISIBLE,
    CONSTRAINT `fk_enveloppe_comptecourant1`
        FOREIGN KEY (`comptecourant_idcomptecourant`)
            REFERENCES `bddprojet`.`comptecourant` (`idcomptecourant`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION,
    CONSTRAINT `fk_enveloppe_comptebourse1`
        FOREIGN KEY (`comptebourse_idcomptebourse`)
            REFERENCES `bddprojet`.`comptebourse` (`idcomptebourse`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`historique`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`historique`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`historique`
(
    `idhistorique`  INT   NOT NULL AUTO_INCREMENT,
    `idutilisateur` INT   NULL,
    `montant`       FLOAT NULL,
    `date`          DATE  NULL,
    PRIMARY KEY (`idhistorique`)
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`operation`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`operation`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`operation`
(
    `idoperation`                   INT         NOT NULL AUTO_INCREMENT,
    `description`                   VARCHAR(45) NULL,
    `montant`                       FLOAT       NULL,
    `date`                          DATE        NULL,
    `comptecourant_idcomptecourant` INT         NOT NULL,
    PRIMARY KEY (`idoperation`),
    INDEX `fk_operation_comptecourant1_idx` (`comptecourant_idcomptecourant` ASC) VISIBLE,
    CONSTRAINT `fk_operation_comptecourant1`
        FOREIGN KEY (`comptecourant_idcomptecourant`)
            REFERENCES `bddprojet`.`comptecourant` (`idcomptecourant`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`pea`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`pea`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`pea`
(
    `idpea`                       INT         NOT NULL AUTO_INCREMENT,
    `comptebourse_idcomptebourse` INT         NOT NULL,
    `intitule`                    VARCHAR(45) NULL,
    `montant`                     FLOAT       NULL,
    PRIMARY KEY (`idpea`),
    INDEX `fk_pea_comptebourse1_idx` (`comptebourse_idcomptebourse` ASC) VISIBLE,
    CONSTRAINT `fk_pea_comptebourse1`
        FOREIGN KEY (`comptebourse_idcomptebourse`)
            REFERENCES `bddprojet`.`comptebourse` (`idcomptebourse`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`pea_has_action`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`pea_has_action`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`pea_has_action`
(
    `pea_idpea`       INT   NOT NULL,
    `action_idaction` INT   NOT NULL,
    `prixachat`       FLOAT NULL,
    `quantite`        INT   NULL,
    `dateachat`       DATE  NULL,
    PRIMARY KEY (`pea_idpea`, `action_idaction`),
    INDEX `fk_pea_has_action_action1_idx` (`action_idaction` ASC) VISIBLE,
    INDEX `fk_pea_has_action_pea1_idx` (`pea_idpea` ASC) VISIBLE,
    CONSTRAINT `fk_pea_has_action_pea1`
        FOREIGN KEY (`pea_idpea`)
            REFERENCES `bddprojet`.`pea` (`idpea`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION,
    CONSTRAINT `fk_pea_has_action_action1`
        FOREIGN KEY (`action_idaction`)
            REFERENCES `bddprojet`.`action` (`idaction`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `bddprojet`.`utilisateur`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `bddprojet`.`utilisateur`;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `bddprojet`.`utilisateur`
(
    `idutilisateur`         INT         NOT NULL AUTO_INCREMENT,
    `nom`                   VARCHAR(45) NULL,
    `prenom`                VARCHAR(45) NULL,
    `mdp`                   VARCHAR(45) NULL,
    `enveloppe_idenveloppe` INT         NOT NULL,
    PRIMARY KEY (`idutilisateur`),
    INDEX `fk_utilisateur_enveloppe1_idx` (`enveloppe_idenveloppe` ASC) VISIBLE,
    CONSTRAINT `fk_utilisateur_enveloppe1`
        FOREIGN KEY (`enveloppe_idenveloppe`)
            REFERENCES `bddprojet`.`enveloppe` (`idenveloppe`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB;

SHOW WARNINGS;

SET SQL_MODE = @OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS = @OLD_UNIQUE_CHECKS;

insert into comptecourant (idcomptecourant, montant)
values (1, 300),
       (2, 500);
insert into comptebourse
values (1),
       (2);
insert into enveloppe
values (1, 1, 1),
       (2, 2, 2);
insert into utilisateur
values (1, 'Bouvart', 'Erwan', '123', 1),
       (2, 'Briand', 'Florian', '123', 2);
insert into operation
values (1, 'premier virement erwan', 300, '2022-01-03', 1),
       (2, 'premier virement Florian', 500, '2022-01-03', 2);

insert into pea
values (1, 1, 'PEA', 0);
INSERT INTO bddprojet.pea (idpea, comptebourse_idcomptebourse, intitule, montant)
VALUES (2, 2, 'Pea Florian', 500);
INSERT INTO bddprojet.assurancevie (idassurancevie, comptebourse_idcomptebourse, intitule, montant)
VALUES (1, 2, 'Assurance Vie Florian', 800);

INSERT INTO `action`
VALUES (1, 177.57, 'AAPL', 'Apple Inc.'),
       (2, 567.06, 'ADBE', 'Adobe Inc.'),
       (3, 224.97, 'AMGN', 'Amgen Inc.'),
       (4, 3334.34, 'AMZN', 'Amazon.com, Inc.'),
       (5, 665.41, 'AVGO', 'Broadcom Inc.'),
       (6, 50.33, 'CMCSA', 'Comcast Corporation'),
       (7, 63.37, 'CSCO', 'Cisco Systems, Inc.'),
       (8, 336.35, 'FB', 'Meta Platforms'),
       (9, 2893.59, 'GOOG', 'Alphabet Inc.'),
       (10, 51.5, 'INTC', 'Intel Corporation'),
       (11, 336.32, 'MSFT', 'Microsoft'),
       (12, 602.44, 'NFLX', 'Netflix, Inc.'),
       (13, 294.11, 'NVDA', 'NVIDIA Corporation'),
       (14, 173.71, 'PEP', 'PepsiCo, Inc.'),
       (15, 188.58, 'PYPL', 'PayPal Holdings');

insert into pea_has_action
values (1, 1, 177.57, 2, '2022-01-03');

insert into historique
values (1, 2, 500, '2022-01-03'),
       (2, 1, 300, '2022-01-03');